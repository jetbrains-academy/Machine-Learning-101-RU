### K-means

В данном уроке представлена задача кластеризации - разбиения выборки на непересекающиеся множества, объекты которых схожи между собой и отличаются от объектов других множеств. Центры подобных множеств будут определять цвета, на которые будут заменены их элементы на изображении.

Алгоритм кластеризации с помощью k-средних (k-means algorithm) - вид обучения без учителя, применяемый в случае, если группы, получаемые в результате классификации (кластеры) неизвестны.
Задача этого алгоритма - разбить выборку на `k` групп.

Алгоритм итеративно присваивает каждый из объектов выборки одной из `k` групп, основываясь на предоставленных признаках. Кластеры образуются из объектов со схожими признаками.

В алгоритме применяется итеративное улучшение результата. На вход подаются количество кластеров и набор данных, содержащий признаки каждого из объектов (в данном случае - значения красного, синего и зеленого каналов для каждой из точек). Алгоритм начинает с первоначального определения `k` центроидов, которые могут быть сгенерированы случайно, или же наугад выбраны из входного набора данных. После этого итеративно повторяются два шага:

1. Шаг распределения объектов. На данном этапе каждому объекту присваивается кластер с ближайшим центроидом. Более формально:

$$c_i = \underset{{c \in 1\dots k}}{\arg\min}  \rho(x_i, \mu_c)$$

где
- $c_i$ -- центр кластера, присвоенный объекту $x_i$
- $\rho(x_i, \mu_c)$ -- расстояние между объектом $x_i$ и центром кластера $\mu_c$
- $\mu_{c}$ -- центр кластера

2. Шаг обновления центроидов. На данном этапе происходит перерасчет центроидов как среднего среди точек, присвоенных их кластерам.

$$ {\mu_{c} = \frac{\sum\limits_{j=1,\dots, n} [c_i = c] x_i^j}{\sum\limits_{c_i = c} 1} } $$


Алгоритм повторяет шаги один и два, пока не будет достигнуто условие останова: на какой-то итерпции ни один из объектов не изменит свой кластер, будет достигнута минимальная сумма расстояний или будет пройдено некое предельное количество итераций.
При наличии данных условий алгоритм гарантированно сходится.

Однако стоит учитывать, что на первом шаге может образоваться кластер, которому не принадлежит ни одна точка. Это может быть следствием неудачных изначальных центроидов или слишком большого k. Такие случаи необходимо отдельно обрабатывать на втором шаге, чтобы избежать ошибки при вычислении их среднего. Здесь возможны различные подходы, к примеру присвоение пустому кластеру случайной точки, или точки, наиболее удаленной от центра наибольшего кластера. 


### Задание

Реализуйте функцию, `k_means(X, n_clusters, distance_metric)`, которая принимает матрицу $X$ размерности
`(n_samples, n_features)`, количество кластеров, на которые мы хотим разбить изображение и метрику. 

Результатом работы функции является пара из вектора размера `n_samples`, где в $i$-й ячейке содержится кластер,
соответствующий $i$-му пикселю, и вектор размера `(n_clusters)` с центрами кластеров.

При выполнении задания может пригодиться функция [numpy.sum](https://numpy.org/doc/1.18/reference/generated/numpy.sum.html), вычисляющая сумму элементов массива.